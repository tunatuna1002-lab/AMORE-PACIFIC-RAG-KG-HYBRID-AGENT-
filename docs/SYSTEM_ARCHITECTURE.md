# AMORE RAG-KG Hybrid Agent - ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜ ì „ì²´ í•´ì„¤

---

## 1. í”„ë¡œì íŠ¸ ì •ì²´ì„±

**Amazon US LANEIGE ë¸Œëœë“œ ê²½ìŸë ¥ ëª¨ë‹ˆí„°ë§ ììœ¨ AI ì‹œìŠ¤í…œ**

ë§¤ì¼ ì•„ë§ˆì¡´ ë² ìŠ¤íŠ¸ì…€ëŸ¬ Top 100ì„ 5ê°œ ì¹´í…Œê³ ë¦¬ì—ì„œ í¬ë¡¤ë§í•˜ê³ , Knowledge Graph + RAG + Ontology ì¶”ë¡ ì„ ê²°í•©í•˜ì—¬ ì‹œì¥ ì¸ì‚¬ì´íŠ¸ë¥¼ ìƒì„±í•˜ë©°, AI ì±—ë´‡ìœ¼ë¡œ ì‹¤ì‹œê°„ ë¶„ì„ì„ ì œê³µí•©ë‹ˆë‹¤.

---

## 2. ì „ì²´ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        PRESENTATION LAYER                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Dashboard (HTML/JS) â”‚  â”‚  Telegram Admin Bot              â”‚    â”‚
â”‚  â”‚  amore_unified_      â”‚  â”‚  /logs /status /crawl /kg /db    â”‚    â”‚
â”‚  â”‚  dashboard_v4.html   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                          â”‚
â”‚             â”‚ REST API                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚             â–¼          API LAYER (FastAPI)                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚  dashboard_api.py (Entry Point)                         â”‚       â”‚
â”‚  â”‚  â”œâ”€â”€ /api/health          GET   Healthcheck             â”‚       â”‚
â”‚  â”‚  â”œâ”€â”€ /api/data            GET   Dashboard JSON          â”‚       â”‚
â”‚  â”‚  â”œâ”€â”€ /api/v3/chat         POST  AI Chatbot              â”‚       â”‚
â”‚  â”‚  â”œâ”€â”€ /api/crawl/start     POST  Manual Crawl (API Key)  â”‚       â”‚
â”‚  â”‚  â”œâ”€â”€ /api/v4/brain/status GET   Scheduler Status        â”‚       â”‚
â”‚  â”‚  â”œâ”€â”€ /api/export/docx     POST  Async DOCX Export       â”‚       â”‚
â”‚  â”‚  â”œâ”€â”€ /api/signals/news    GET   Tavily News             â”‚       â”‚
â”‚  â”‚  â””â”€â”€ /webhook/telegram    POST  Telegram Webhook        â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                         â–¼                                          â”‚
â”‚              ORCHESTRATION LAYER (src/core/)                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚              UnifiedBrain (brain.py)                     â”‚       â”‚
â”‚  â”‚     "ììœ¨ ìŠ¤ì¼€ì¤„ëŸ¬ + ì¿¼ë¦¬ ë¼ìš°í„° + ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„°"         â”‚       â”‚
â”‚  â”‚                                                         â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚       â”‚
â”‚  â”‚  â”‚  Scheduler  â”‚  â”‚ Query Router â”‚  â”‚  Crawl Mgr    â”‚  â”‚       â”‚
â”‚  â”‚  â”‚ (22:00 KST) â”‚  â”‚  ë³µì¡ë„ íŒë‹¨  â”‚  â”‚  ìƒíƒœ ê´€ë¦¬     â”‚  â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚       â”‚
â”‚  â”‚         â”‚               â”‚                   â”‚          â”‚       â”‚
â”‚  â”‚         â–¼               â–¼                   â–¼          â”‚       â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚       â”‚
â”‚  â”‚  â”‚  Batch  â”‚   â”‚  ReAct Agent â”‚   â”‚  Alert Mgr   â”‚    â”‚       â”‚
â”‚  â”‚  â”‚Workflow â”‚   â”‚ (Self-Reflect)â”‚   â”‚ (Email/TG)   â”‚    â”‚       â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚          â–¼               â–¼                                         â”‚
â”‚                    AGENT LAYER (src/agents/)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ CrawlerAgent â”‚ â”‚HybridChatbotAgentâ”‚ â”‚HybridInsightAgent â”‚       â”‚
â”‚  â”‚  í¬ë¡¤ë§ ì‹¤í–‰  â”‚ â”‚ KG+RAG+Ontology â”‚ â”‚  ì „ëµ ì¸ì‚¬ì´íŠ¸     â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ í•˜ì´ë¸Œë¦¬ë“œ ì±—ë´‡   â”‚ â”‚  ì™¸ë¶€ì‹ í˜¸ ìœµí•©     â”‚       â”‚
â”‚         â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚         â”‚                  â”‚                     â”‚                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚ MetricsAgent â”‚ â”‚ StorageAgent â”‚  â”‚ AlertAgent       â”‚          â”‚
â”‚  â”‚ SoS/HHI/CPI â”‚ â”‚ SQLite+Sheet â”‚  â”‚ ìˆœìœ„ë³€ë™ ì•Œë¦¼     â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              HYBRID RETRIEVAL LAYER                                â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ RAG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€ Ontology â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  src/rag/                 â”‚  â”‚  src/ontology/            â”‚      â”‚
â”‚  â”‚                           â”‚  â”‚                           â”‚      â”‚
â”‚  â”‚  HybridRetriever          â”‚  â”‚  KnowledgeGraph           â”‚      â”‚
â”‚  â”‚  â”œâ”€ QueryIntent ë¶„ë¥˜      â”‚  â”‚  â”œâ”€ Triple Store (50K)    â”‚      â”‚
â”‚  â”‚  â”œâ”€ EntityLinker          â”‚  â”‚  â”œâ”€ Subject/Object Index  â”‚      â”‚
â”‚  â”‚  â””â”€ ContextBuilder        â”‚  â”‚  â””â”€ JSON Persistence      â”‚      â”‚
â”‚  â”‚                           â”‚  â”‚                           â”‚      â”‚
â”‚  â”‚  DocumentRetriever        â”‚  â”‚  OntologyReasoner          â”‚      â”‚
â”‚  â”‚  â”œâ”€ 14ê°œ ì°¸ì¡°ë¬¸ì„œ          â”‚  â”‚  â”œâ”€ Rule-based Inference  â”‚      â”‚
â”‚  â”‚  â”œâ”€ Embedding Cache       â”‚  â”‚  â”œâ”€ Business Rules        â”‚      â”‚
â”‚  â”‚  â””â”€ ChromaDB (ì„ íƒ)       â”‚  â”‚  â””â”€ Insight Generation    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                    â”‚                        â”‚                      â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                      â”‚
â”‚                             â–¼                                      â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                   â”‚  HybridContext   â”‚                              â”‚
â”‚                   â”‚  â”œ ontology_factsâ”‚                              â”‚
â”‚                   â”‚  â”œ inferences    â”‚                              â”‚
â”‚                   â”‚  â”œ rag_chunks    â”‚                              â”‚
â”‚                   â”‚  â”” combined_ctx  â”‚                              â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚                            â–¼                                       â”‚
â”‚                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚                   â”‚  LLM (GPT-4.1)  â”‚                              â”‚
â”‚                   â”‚  via LiteLLM    â”‚                              â”‚
â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    TOOLS LAYER (src/tools/)                         â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€ Crawling â”€â”€â”  â”Œâ”€â”€ Social â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€ Utility â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚AmazonScraper â”‚  â”‚TikTok(PW)      â”‚  â”‚MetricCalculator   â”‚      â”‚
â”‚  â”‚ Playwright   â”‚  â”‚Instagram(IL)   â”‚  â”‚SQLiteStorage      â”‚      â”‚
â”‚  â”‚ Stealth      â”‚  â”‚YouTube(yt-dlp) â”‚  â”‚SheetsWriter       â”‚      â”‚
â”‚  â”‚ Browserforge â”‚  â”‚Reddit(JSON)    â”‚  â”‚KGBackup (7ì¼)     â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚GoogleTrends    â”‚  â”‚EmailSender(SMTP)  â”‚      â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚TelegramBot        â”‚      â”‚
â”‚                                        â”‚JobQueue           â”‚      â”‚
â”‚  â”Œâ”€â”€ Public Data â”                     â”‚ClaimExtractor     â”‚      â”‚
â”‚  â”‚ê´€ì„¸ì²­ ìˆ˜ì¶œì…   â”‚                     â”‚ClaimVerifier      â”‚      â”‚
â”‚  â”‚ì‹ì•½ì²˜ í™”ì¥í’ˆ   â”‚                     â”‚ConfidenceScorer   â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 DOMAIN LAYER (src/domain/) - Layer 1               â”‚
â”‚  â”Œâ”€â”€ Entities â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€ Interfaces (Protocol) â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Product, RankRecord      â”‚  â”‚ CrawlerAgentProtocol           â”‚ â”‚
â”‚  â”‚ Brand, BrandMetrics      â”‚  â”‚ StorageAgentProtocol           â”‚ â”‚
â”‚  â”‚ Category, Snapshot       â”‚  â”‚ KnowledgeGraphProtocol         â”‚ â”‚
â”‚  â”‚ Relation, RelationType   â”‚  â”‚ RetrieverProtocol              â”‚ â”‚
â”‚  â”‚ InferenceResult          â”‚  â”‚ LLMClientProtocol              â”‚ â”‚
â”‚  â”‚ AmoreAgentError (base)   â”‚  â”‚ ProductRepository              â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚              INFRASTRUCTURE (src/infrastructure/)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ConfigManager   â”‚  â”‚ Bootstrap    â”‚  â”‚ JSON/Sheets Repo     â”‚  â”‚
â”‚  â”‚ (thresholds.jsonâ”‚  â”‚ (DI Containerâ”‚  â”‚ (Persistence)        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     STORAGE LAYER                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚   SQLite     â”‚  â”‚ Google Sheetsâ”‚  â”‚ Knowledge Graph JSON   â”‚   â”‚
â”‚  â”‚  (Primary)   â”‚  â”‚  (Backup)    â”‚  â”‚  (50K triples)         â”‚   â”‚
â”‚  â”‚ /data/*.db   â”‚  â”‚              â”‚  â”‚ /data/knowledge_graph  â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 3. í•µì‹¬ ë°ì´í„° íë¦„

### 3.1 ì¼ì¼ ìë™ í¬ë¡¤ë§ íŒŒì´í”„ë¼ì¸

```
22:00 KST (APScheduler)
    â”‚
    â–¼
UnifiedBrain.execute_crawl()
    â”‚
    â–¼
AmazonScraper (Playwright + Stealth + Browserforge)
    â”œâ”€â”€ Beauty & Personal Care  (Top 100)
    â”œâ”€â”€ Skin Care               (Top 100)
    â”œâ”€â”€ Lip Care                (Top 100)  â† LANEIGE Lip Sleeping Mask
    â”œâ”€â”€ Lip Makeup              (Top 100)  â† ë¦½ìŠ¤í‹±/ë¦½ê¸€ë¡œìŠ¤
    â””â”€â”€ Face Powder             (Top 100)
    â”‚
    â–¼ ìˆ˜ì§‘ ë°ì´í„°: ASIN, ì œëª©, ë¸Œëœë“œ, ìˆœìœ„, ê°€ê²©, í‰ì , ë¦¬ë·°ìˆ˜, ë°°ì§€, ì¿ í°
    â”‚
    â”œâ”€â”€â–¶ SQLite (Source of Truth)
    â”œâ”€â”€â–¶ Google Sheets (Backup)
    â”‚
    â–¼
KnowledgeGraph ì—…ë°ì´íŠ¸
    â”œâ”€â”€ (Brand) â”€HAS_PRODUCTâ”€â–¶ (ASIN)
    â”œâ”€â”€ (ASIN) â”€BELONGS_TO_CATEGORYâ”€â–¶ (Category)
    â””â”€â”€ (Brand) â”€COMPETES_WITHâ”€â–¶ (Brand)
    â”‚
    â–¼
MetricsAgent ê³„ì‚°
    â”œâ”€â”€ SoS = LANEIGE ì œí’ˆìˆ˜ / Top N Ã— 100
    â”œâ”€â”€ HHI = Î£(ì ìœ ìœ¨Â²) â†’ ì‹œì¥ì§‘ì¤‘ë„
    â””â”€â”€ CPI = LANEIGE í‰ê· ê°€ / ì¹´í…Œê³ ë¦¬ í‰ê· ê°€ Ã— 100
    â”‚
    â–¼
HybridInsightAgent
    â”œâ”€â”€ Ontology Reasoner â†’ ê·œì¹™ ê¸°ë°˜ ì¶”ë¡ 
    â”œâ”€â”€ RAG ì°¸ì¡°ë¬¸ì„œ â†’ ì „ëµ ê°€ì´ë“œ
    â”œâ”€â”€ ì™¸ë¶€ ì‹ í˜¸ (Tavily ë‰´ìŠ¤, Google Trends)
    â””â”€â”€ LLM í•©ì„± â†’ ì „ëµì  ì¸ì‚¬ì´íŠ¸
    â”‚
    â–¼
AlertAgent â†’ Email/Telegram ì•Œë¦¼ (ìˆœìœ„ Â±10, SoS ë³€ë™)
```

### 3.2 ì±—ë´‡ ì¿¼ë¦¬ ì²˜ë¦¬ íë¦„

```
ì‚¬ìš©ì: "LANEIGEê°€ ê²½ìŸì‚¬ ëŒ€ë¹„ ì–´ë–¤ ìœ„ì¹˜ì— ìˆë‚˜ìš”?"
    â”‚
    â–¼
UnifiedBrain.process_query()
    â”‚
    â”œâ”€â”€ ë³µì¡ë„ íŒë‹¨: "ê²½ìŸì‚¬", "ìœ„ì¹˜", "ë¶„ì„" â†’ Complex!
    â”‚
    â–¼
ReActAgent (Self-Reflection Loop, max 3íšŒ)
    â”‚
    â”‚  Iteration 1:
    â”‚  â”œâ”€â”€ Thought: "ê²½ìŸì‚¬ ë¹„êµë¥¼ ìœ„í•´ KGì—ì„œ ê´€ê³„ ì¡°íšŒ í•„ìš”"
    â”‚  â”œâ”€â”€ Action: search_knowledge("LANEIGE COMPETES_WITH")
    â”‚  â”œâ”€â”€ Observation: [COSRX, Neutrogena, CeraVe...]
    â”‚  â””â”€â”€ Reflection: confidence=0.5, needs_improvement=true
    â”‚
    â”‚  Iteration 2:
    â”‚  â”œâ”€â”€ Thought: "SoS/HHI ì§€í‘œë¡œ ì •ëŸ‰ì  ë¹„êµ í•„ìš”"
    â”‚  â”œâ”€â”€ Action: calculate_metrics("lip_care")
    â”‚  â”œâ”€â”€ Observation: {SoS: 8.3%, HHI: 0.12, rank: 3}
    â”‚  â””â”€â”€ Reflection: confidence=0.85, needs_improvement=false
    â”‚
    â–¼
HybridChatbotAgent.chat()
    â”‚
    â”œâ”€â”€ EntityExtractor
    â”‚   â”œâ”€â”€ Brands: ["LANEIGE", "COSRX", "CeraVe"]
    â”‚   â”œâ”€â”€ Categories: ["lip_care"]
    â”‚   â””â”€â”€ Metrics: ["sos", "rank", "competition"]
    â”‚
    â”œâ”€â”€ Parallel Retrieval â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚   â”œâ”€â”€ KnowledgeGraph.query()              â”‚
    â”‚   â”‚   â””â”€â”€ Facts: 23 triples              â”‚
    â”‚   â”‚                                       â”‚
    â”‚   â”œâ”€â”€ OntologyReasoner.infer()            â”‚
    â”‚   â”‚   â””â”€â”€ Inferences:                    â”‚
    â”‚   â”‚       "LANEIGE SoS 8.3% â†’ ì¤‘ìœ„ê¶Œ"    â”‚
    â”‚   â”‚       "HHI 0.12 â†’ ë¶„ì‚°ëœ ì‹œì¥"        â”‚
    â”‚   â”‚                                       â”‚
    â”‚   â””â”€â”€ DocumentRetriever.search()          â”‚
    â”‚       â””â”€â”€ RAG chunks: 5ê°œ ë¬¸ì„œ ë°œì·Œ       â”‚
    â”‚           (Embedding Cache Hit Rate: 67%) â”‚
    â”‚                                           â”‚
    â”œâ”€â”€ HybridContext êµ¬ì„± â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚   â”œâ”€â”€ ontology_facts
    â”‚   â”œâ”€â”€ inferences
    â”‚   â”œâ”€â”€ rag_chunks
    â”‚   â””â”€â”€ combined_context (unified text)
    â”‚
    â–¼
LLM (GPT-4.1-mini, temp=0.4)
    â”‚
    â–¼
Response:
    â”œâ”€â”€ answer: "LANEIGEëŠ” Lip Care ì¹´í…Œê³ ë¦¬ì—ì„œ..."
    â”œâ”€â”€ sources: [{title, url, relevance}]
    â”œâ”€â”€ confidence: 0.85
    â””â”€â”€ metadata: {mode: "react", iterations: 2}
```

---

## 4. ë ˆì´ì–´ë³„ ìƒì„¸ ì„¤ëª…

### 4.1 Core Layer - ë‘ë‡Œ (`src/core/`)

| íŒŒì¼ | ì—­í•  | í•µì‹¬ ë©”ì„œë“œ |
|------|------|------------|
| `brain.py` (1,556ì¤„) | ììœ¨ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´í„° | `process_query()`, `execute_crawl()`, `start_scheduler()` |
| `react_agent.py` (321ì¤„) | ReAct ìê¸°ì„±ì°° ë£¨í”„ | `run()` â†’ Thoughtâ†’Actionâ†’Observationâ†’Reflection |
| `batch_workflow.py` | ì¼ì¼ ë°°ì¹˜ íŒŒì´í”„ë¼ì¸ | CRAWLâ†’STOREâ†’KGâ†’CALCULATEâ†’INSIGHTâ†’EXPORT |
| `crawl_manager.py` | í¬ë¡¤ë§ ìƒíƒœ ê´€ë¦¬ | `start_crawl()`, `get_status()` |
| `scheduler.py` | APScheduler í†µí•© | ë§¤ì¼ 22:00 KST (UTC 13:00) |
| `query_processor.py` | ì¿¼ë¦¬ ì˜ë„ ë¶„ë¥˜ | í‚¤ì›Œë“œ/íŒ¨í„´ ê¸°ë°˜ ë¶„ë¥˜ |
| `verification_pipeline.py` | ì‘ë‹µ ê²€ì¦ | Claim ì¶”ì¶œ â†’ ì‚¬ì‹¤ ê²€ì¦ |
| `cache.py` | TTL ê¸°ë°˜ ìºì‹± | 5ë¶„ TTL, ìë™ ë§Œë£Œ |

**UnifiedBrain - ë³µì¡ë„ íŒë‹¨ ê¸°ì¤€:**
```
Simple â†’ HybridChatbotAgent ì§ì ‘ ì²˜ë¦¬
Complex â†’ ReActAgent í™œì„±í™”
  â”œâ”€â”€ "ë¶„ì„", "ë¹„êµ", "ì™œ", "ì›ì¸" ë“± ë¶„ì„ í‚¤ì›Œë“œ
  â”œâ”€â”€ ë©€í‹° ì—”í‹°í‹° ì§ˆë¬¸ (3+ ë¸Œëœë“œ/ì¹´í…Œê³ ë¦¬)
  â””â”€â”€ ì»¨í…ìŠ¤íŠ¸ ë¶€ì¡± (ì¶”ê°€ ì¡°íšŒ í•„ìš”)
```

### 4.2 Agent Layer - ì „ë¬¸ ì—ì´ì „íŠ¸ (`src/agents/`)

| ì—ì´ì „íŠ¸ | ì—­í•  | ì…ë ¥ â†’ ì¶œë ¥ |
|----------|------|------------|
| `HybridChatbotAgent` | AI ì±—ë´‡ (ë©”ì¸) | ì¿¼ë¦¬ â†’ KG+RAG+Ontology ìœµí•© ë‹µë³€ |
| `HybridInsightAgent` | ì „ëµ ì¸ì‚¬ì´íŠ¸ | í¬ë¡¤ë§ ë°ì´í„° â†’ ì‹œì¥ ë¶„ì„ ë³´ê³ ì„œ |
| `CrawlerAgent` | í¬ë¡¤ë§ ë˜í¼ | ì¹´í…Œê³ ë¦¬ â†’ Amazon Top 100 ë°ì´í„° |
| `StorageAgent` | ì˜ì†í™” | ë°ì´í„° â†’ SQLite + Google Sheets |
| `MetricsAgent` | KPI ê³„ì‚° | ìˆœìœ„ ë°ì´í„° â†’ SoS, HHI, CPI |
| `AlertAgent` | ì•Œë¦¼ ë°œìƒ | ë³€ë™ ê°ì§€ â†’ Email/Telegram |
| `PeriodInsightAgent` | ì£¼ê°„/ì›”ê°„ ë¦¬í¬íŠ¸ | ê¸°ê°„ ë°ì´í„° â†’ íŠ¸ë Œë“œ ë¶„ì„ |

### 4.3 RAG Layer - ë¬¸ì„œ ê²€ìƒ‰ (`src/rag/`)

**QueryIntent ê¸°ë°˜ ë¬¸ì„œ ë¼ìš°íŒ…:**
```
DIAGNOSIS (ì§„ë‹¨)  â†’ ì•„ë§ˆì¡´ ë­í‚¹ ê¸‰ë“± ì›ì¸ ë¶„ì„ ê°€ì´ë“œ
TREND (íŠ¸ë Œë“œ)    â†’ K-ë·°í‹° ì‹œì¥ íŠ¸ë Œë“œ ë ˆì´ë”
CRISIS (ìœ„ê¸°)     â†’ ë¶€ì • ì´ìŠˆ ì¡°ê¸°ê²½ë³´ ëŒ€ì‘ í”„ë¡¬í”„íŠ¸
METRIC (ì§€í‘œ)     â†’ Strategic Indicators Definition
GENERAL (ì¼ë°˜)    â†’ ì „ì²´ ë¬¸ì„œ ê²€ìƒ‰
```

**14ê°œ ì°¸ì¡° ë¬¸ì„œ (docs/ ë””ë ‰í† ë¦¬):**
- Type D: ì§€í‘œ ì •ì˜, í•´ì„ ê°€ì´ë“œ, ì¡°í•© Playbook, í™ˆí˜ì´ì§€ ê·œì¹™
- Type A: ë­í‚¹ ê¸‰ë“± ì›ì¸ ë¶„ì„, ë³€ë™ ì›ì¸ ê°€ì´ë“œ
- Type B: K-ë·°í‹° íŠ¸ë Œë“œ, ë¯¸êµ­ ë·°í‹° ë ˆì´ë”
- Type C: ë¶€ì • ì´ìŠˆ ê²½ë³´, ì¸í”Œë£¨ì–¸ì„œ ë§µ
- Type E: IR ë³´ê³ ì„œ (1Q/2Q/3Q 2025)

**Embedding Cache:**
```
MD5(query_text) â†’ cached_embedding
â”œâ”€â”€ ìµœëŒ€ 1,000ê°œ ì—”íŠ¸ë¦¬
â”œâ”€â”€ FIFO ë°©ì‹ eviction
â”œâ”€â”€ Hit Rate ì¶”ì  (33%+ API ë¹„ìš© ì ˆê°)
â””â”€â”€ ~6KB/entry (1000ê°œ â‰ˆ 6MB)
```

### 4.4 Ontology Layer - ì§€ì‹ ì¶”ë¡  (`src/ontology/`)

**Knowledge Graph êµ¬ì¡°:**
```
Triple: (Subject, Predicate, Object)

ê´€ê³„ ìœ í˜• (RelationType):
  HAS_PRODUCT          "LANEIGE" â”€â”€â–¶ "B07X3Y1B2Z"
  BELONGS_TO_CATEGORY  "B07X3Y1B2Z" â”€â”€â–¶ "lip_care"
  COMPETES_WITH        "LANEIGE" â—€â”€â”€â–¶ "COSRX"
  PARENT_CATEGORY      "lip_care" â”€â”€â–¶ "skin_care"
  HAS_SUBCATEGORY      "skin_care" â”€â”€â–¶ "lip_care"
  HAS_SENTIMENT        "B07X3Y1B2Z" â”€â”€â–¶ "positive"
  HAS_AI_SUMMARY       "B07X3Y1B2Z" â”€â”€â–¶ "Best seller..."

ì¸ë±ìŠ¤:
  subject_index  : {entity â†’ [ê´€ë ¨ triples]}
  object_index   : {entity â†’ [ê´€ë ¨ triples]}
  predicate_index: {relation_type â†’ [triples]}

ì œí•œ: ìµœëŒ€ 50,000 triples (ì¤‘ìš”ë„ ê¸°ë°˜ eviction)
```

**Ontology Reasoner - ê·œì¹™ ê¸°ë°˜ ì¶”ë¡ :**
```python
Rule: "LOW_SOS_WARNING"
  IF: brand.sos < 5%
  THEN: InsightType.RISK_ALERT
        "ë¸Œëœë“œ ì ìœ ìœ¨ ìœ„í—˜ ìˆ˜ì¤€"

Rule: "HIGH_CONCENTRATION"
  IF: category.hhi > 0.25
  THEN: InsightType.MARKET_STRUCTURE
        "ì‹œì¥ ê³¼ì  êµ¬ì¡° ê°ì§€"

Rule: "COMPETITIVE_THREAT"
  IF: competitor.rank_change < -10
  THEN: InsightType.COMPETITIVE_POSITION
        "ê²½ìŸì‚¬ ê¸‰ë¶€ìƒ ê²½ê³ "
```

### 4.5 Tools Layer - ìˆ˜ì§‘ ë° ìœ í‹¸ (`src/tools/`)

**Amazon Scraper - Anti-Bot ì „ëµ:**
```
Playwright (Headless Chromium)
  â”œâ”€â”€ playwright-stealth: ìë™í™” ê°ì§€ ìš°íšŒ
  â”œâ”€â”€ browserforge: ë¸Œë¼ìš°ì € í•‘ê±°í”„ë¦°íŠ¸ ìƒì„±
  â”œâ”€â”€ Random User-Agent ë¡œí…Œì´ì…˜
  â”œâ”€â”€ ì§€ìˆ˜ ë°±ì˜¤í”„ (8ì´ˆ base Ã— 2^retry)
  â”œâ”€â”€ Circuit Breaker (3íšŒ ì‹¤íŒ¨ â†’ ì¤‘ë‹¨)
  â””â”€â”€ ì°¨ë‹¨ ê°ì§€ ì‹œ ë””ë²„ê·¸ ìŠ¤í¬ë¦°ìƒ· ì €ì¥
```

**ì†Œì…œ ë¯¸ë””ì–´ ìˆ˜ì§‘ê¸° (ì „ë¶€ ë¬´ë£Œ):**

| í”Œë«í¼ | ë¼ì´ë¸ŒëŸ¬ë¦¬ | ë°©ì‹ |
|--------|-----------|------|
| TikTok | Playwright | ë¸Œë¼ìš°ì € ìë™í™” |
| Instagram | Instaloader | ê³µì‹ ë¹„ê³µì‹ API |
| YouTube | yt-dlp | ë©”íƒ€ë°ì´í„° ì¶”ì¶œ |
| Reddit | requests | JSON API (ì¸ì¦ ë¶ˆí•„ìš”) |
| Google Trends | trendspyg | íŠ¸ë Œë“œ ë°ì´í„° |

### 4.6 Domain Layer - Clean Architecture í•µì‹¬ (`src/domain/`)

```
src/domain/
â”œâ”€â”€ entities/          # ìˆœìˆ˜ ë„ë©”ì¸ ëª¨ë¸ (ì™¸ë¶€ ì˜ì¡´ ì—†ìŒ)
â”‚   â”œâ”€â”€ product.py     # Product, RankRecord, BadgeType
â”‚   â”œâ”€â”€ brand.py       # Brand, BrandMetrics
â”‚   â”œâ”€â”€ market.py      # Category, Snapshot, MarketMetrics
â”‚   â””â”€â”€ relations.py   # Relation, RelationType, InferenceResult
â”‚
â”œâ”€â”€ interfaces/        # Protocol ê¸°ë°˜ ì¸í„°í˜ì´ìŠ¤
â”‚   â”œâ”€â”€ agent.py       # CrawlerAgentProtocol
â”‚   â”œâ”€â”€ knowledge_graph.py
â”‚   â”œâ”€â”€ retriever.py
â”‚   â”œâ”€â”€ scraper.py
â”‚   â””â”€â”€ llm_client.py
â”‚
â””â”€â”€ exceptions.py      # AmoreAgentError ê³„ì¸µ
```

**ì˜ì¡´ì„± ê·œì¹™ (ì•ˆìª½ìœ¼ë¡œë§Œ):**
```
Infrastructure â†’ Domain  âœ…
Application â†’ Domain     âœ…
Domain â†’ Application     âŒ ì ˆëŒ€ ê¸ˆì§€
Domain â†’ Infrastructure  âŒ ì ˆëŒ€ ê¸ˆì§€
```

---

## 5. KPI ê³„ì‚° ê³µì‹

| ì§€í‘œ | ê³µì‹ | ì˜ë¯¸ |
|------|------|------|
| **SoS** (Share of Shelf) | LANEIGE ì œí’ˆìˆ˜ Ã· Top N Ã— 100 | ì§„ì—´ëŒ€ ì ìœ ìœ¨ |
| **HHI** (Herfindahl Index) | Î£(ì‹œì¥ì ìœ ìœ¨Â²) | ì‹œì¥ ì§‘ì¤‘ë„ (>0.25 = ê³¼ì ) |
| **CPI** (Category Price Index) | LANEIGE í‰ê· ê°€ Ã· ì¹´í…Œê³ ë¦¬ í‰ê· ê°€ Ã— 100 | ê°€ê²© í¬ì§€ì…”ë‹ |

---

## 6. ì¹´í…Œê³ ë¦¬ ê³„ì¸µ êµ¬ì¡°

```
Beauty & Personal Care (L0) â”€â”€â”€ Node: beauty
â”œâ”€â”€ Skin Care (L1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Node: 11060451
â”‚   â””â”€â”€ Lip Care (L2) â”€â”€â”€â”€â”€â”€â”€â”€ Node: 3761351
â”‚       â””â”€â”€ LANEIGE Lip Sleeping Mask ğŸ¯
â”‚
â””â”€â”€ Makeup (L1)
    â”œâ”€â”€ Lips (L2) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Node: 11059031
    â”‚   â””â”€â”€ ë¦½ìŠ¤í‹±, ë¦½ê¸€ë¡œìŠ¤
    â””â”€â”€ Face (L2)
        â””â”€â”€ Powder (L3) â”€â”€â”€â”€â”€â”€ Node: 11058971
```

> **Lip Care** (ìŠ¤í‚¨ì¼€ì–´ í•˜ìœ„) â‰  **Lip Makeup** (ìƒ‰ì¡° í•˜ìœ„) - ì™„ì „íˆ ë‹¤ë¥¸ ì¹´í…Œê³ ë¦¬

---

## 7. ë°°í¬ ì•„í‚¤í…ì²˜ (Railway)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Railway Cloud           â”‚
â”‚                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  FastAPI Server (Uvicorn) â”‚  â”‚
â”‚  â”‚  PORT: auto-detect        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚             â”‚                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  /data Volume (Persistent)â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ amore_data.db        â”‚  â”‚
â”‚  â”‚  â”œâ”€â”€ knowledge_graph.json â”‚  â”‚
â”‚  â”‚  â””â”€â”€ backups/kg/          â”‚  â”‚
â”‚  â”‚      â””â”€â”€ 7ì¼ ë¡¤ë§ ë°±ì—…     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚  Healthcheck: /api/health       â”‚
â”‚  Timeout: 300s                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ HTTPS
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dashboard      â”‚  â”‚ Telegram Bot â”‚  â”‚ Gmail SMTP   â”‚
â”‚  (Browser)      â”‚  â”‚ (Admin)      â”‚  â”‚ (Alerts)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**3ì¤‘ ì €ì¥ì†Œ:**

| ì €ì¥ì†Œ | ì—­í•  | ìœ„ì¹˜ |
|--------|------|------|
| Railway SQLite | **Source of Truth** | `/data/amore_data.db` |
| Google Sheets | ë°±ì—… | ìŠ¤í”„ë ˆë“œì‹œíŠ¸ |
| ë¡œì»¬ SQLite | ê°œë°œìš© | `./data/amore_data.db` |

---

## 8. ë³´ì•ˆ ë ˆì´ì–´

```
Request â†’ CORS â†’ Security Headers â†’ Rate Limit â†’ API Key Auth â†’ Handler
                                                      â”‚
                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Security Middleware           â”‚
                    â”‚  â”œâ”€â”€ X-Content-Type-Options    â”‚
                    â”‚  â”œâ”€â”€ X-Frame-Options           â”‚
                    â”‚  â”œâ”€â”€ X-XSS-Protection          â”‚
                    â”‚  â”œâ”€â”€ SlowAPI Rate Limiting      â”‚
                    â”‚  â”œâ”€â”€ API Key ë§ˆìŠ¤í‚¹ (sk-****)   â”‚
                    â”‚  â””â”€â”€ Prompt Injection Guard     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. ê¸°ìˆ  ìŠ¤íƒ ìš”ì•½

```
â”Œâ”€â”€ Backend â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€ AI/ML â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€ Storage â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Python 3.11+        â”‚  â”‚ GPT-4.1-mini (LiteLLM)â”‚  â”‚ SQLite              â”‚
â”‚ FastAPI + Uvicorn   â”‚  â”‚ OpenAI Embeddings      â”‚  â”‚ Google Sheets       â”‚
â”‚ APScheduler         â”‚  â”‚ ChromaDB (Vector DB)   â”‚  â”‚ JSON (KG)           â”‚
â”‚ Pydantic v2         â”‚  â”‚ owlready2 (Ontology)   â”‚  â”‚ Railway Volume      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€ Scraping â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€ Social Media â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€ Monitoring â”€â”€â”€â”€â”€â”€â”
â”‚ Playwright          â”‚  â”‚ Playwright (TikTok)    â”‚  â”‚ Telegram Bot API   â”‚
â”‚ playwright-stealth  â”‚  â”‚ Instaloader (IG)       â”‚  â”‚ Gmail SMTP         â”‚
â”‚ browserforge        â”‚  â”‚ yt-dlp (YouTube)       â”‚  â”‚ Python logging     â”‚
â”‚ fake-useragent      â”‚  â”‚ JSON API (Reddit)      â”‚  â”‚ APScheduler jobs   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ trendspyg (Trends)     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€ Testing â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€ DevOps â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ pytest + pytest-cov â”‚  â”‚ Railway (PaaS)         â”‚
â”‚ pytest-asyncio      â”‚  â”‚ Git + pre-commit       â”‚
â”‚ 60% min coverage    â”‚  â”‚ Ruff (linter/fmt)      â”‚
â”‚ Golden set eval     â”‚  â”‚ detect-secrets         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 10. ë””ìì¸ íŒ¨í„´ ì •ë¦¬

| íŒ¨í„´ | ì ìš© ìœ„ì¹˜ | ì„¤ëª… |
|------|----------|------|
| **Clean Architecture** | ì „ì²´ | Domainâ†’Applicationâ†’Infrastructure ê³„ì¸µ ë¶„ë¦¬ |
| **Protocol (DI)** | `src/domain/interfaces/` | ìƒì„±ì ì£¼ì…, ì¸í„°í˜ì´ìŠ¤ ê¸°ë°˜ |
| **ReAct Pattern** | `react_agent.py` | Thoughtâ†’Actionâ†’Observationâ†’Reflection |
| **Circuit Breaker** | `amazon_scraper.py` | 3íšŒ ì‹¤íŒ¨ ì‹œ ìë™ ì¤‘ë‹¨ |
| **TTL Cache** | `cache.py`, `retriever.py` | ì‹œê°„ ê¸°ë°˜ ìë™ ë§Œë£Œ |
| **FIFO Eviction** | Embedding Cache | ìµœëŒ€ 1000ê°œ, ì˜¤ë˜ëœ ê²ƒë¶€í„° ì œê±° |
| **Observer** | AlertAgent | ë³€ë™ ê°ì§€ â†’ ì•Œë¦¼ ë°œí–‰ |
| **Strategy** | QueryIntent | ì˜ë„ë³„ ë‹¤ë¥¸ ê²€ìƒ‰ ì „ëµ |
| **Facade** | UnifiedBrain | ë³µì¡í•œ ì„œë¸Œì‹œìŠ¤í…œ í†µí•© ì¸í„°í˜ì´ìŠ¤ |
