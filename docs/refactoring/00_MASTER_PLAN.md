# AMORE RAG-KG Hybrid Agent - ë¦¬íŒ©í† ë§ ë§ˆìŠ¤í„° í”Œëœ

> ìƒì„±ì¼: 2026-02-10
> ëª©í‘œ: í˜„ì¬ ê¸°ëŠ¥ ìœ ì§€í•˜ë©´ì„œ ì½”ë“œë¥¼ ê°„ê²°Â·ì •í™•Â·ìœ ì§€ë³´ìˆ˜ ê°€ëŠ¥í•˜ê²Œ ì •ë¦¬
> ì›ì¹™: TDD (ì•ˆì „ë§ í…ŒìŠ¤íŠ¸ ë¨¼ì €) + Clean Architecture + ë¡œì»¬ ê²€ì¦ í›„ í‘¸ì‹œ

---

## í˜„í™© ìš”ì•½

| í•­ëª© | ìˆ˜ì¹˜ |
|------|------|
| ì „ì²´ Python | ~97Kì¤„ (src/ 63K, tests/ 15K) |
| ëª¨ë“ˆ ìˆ˜ | 155ê°œ íŒŒì¼ (src/) |
| ìˆœí™˜ ì˜ì¡´ì„± | 23ê°œ ì‚¬ì´í´ |
| í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ | 10.11% (ëª©í‘œ 60%) |
| Application ë ˆì´ì–´ | 120ì¤„ (ê±°ì˜ ë¹„ì–´ìˆìŒ) |
| God Objects (1000ì¤„+) | 19ê°œ íŒŒì¼ |
| Dead Code | ~2000ì¤„+ |

---

## ì˜ì¡´ì„± êµ¬ì¡° (í˜„ì¬)

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ domain  â”‚ â† Layer 1 (ê¹¨ë—í•¨, ì˜ì¡´ ì—†ìŒ)
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                         â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚          â”‚          â”‚
        â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”  â”Œâ”€â”€â”€â”´â”€â”€â”€â”  â”Œâ”€â”€â”´â”€â”€â”€â”€â”€â”€â”
        â”‚ontologyâ”‚  â”‚  rag  â”‚  â”‚applicationâ”‚ â† Layer 2-3 (ì–‘í˜¸)
        â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”¬â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚           â”‚
    â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•ªâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• â† ì—¬ê¸°ì„œë¶€í„° ìˆœí™˜!
            â”‚           â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
     â”‚   core â†” agents â†” tools â”‚ â† Layer 4 (ìˆœí™˜ ì˜ì¡´ì„±)
     â”‚        â†•                â”‚
     â”‚       api               â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ì„¸ì…˜ êµ¬ì„± (ì´ 10ì„¸ì…˜)

### Phase 0: ì¤€ë¹„ (Session 0-1)
| Session | ì‘ì—… | ìœ„í—˜ë„ | ì˜ˆìƒ ê·œëª¨ |
|---------|------|--------|-----------|
| **0** | Dead Code ì‚­ì œ + í´ë” ì •ë¦¬ | ğŸŸ¢ ë‚®ìŒ | ~2000ì¤„ ì‚­ì œ |
| **1** | ì•ˆì „ë§ í…ŒìŠ¤íŠ¸ ì‘ì„± (í•µì‹¬ ê¸°ëŠ¥) | ğŸŸ¢ ë‚®ìŒ | í…ŒìŠ¤íŠ¸ ì¶”ê°€ë§Œ |

### Phase 1: ê¸°ë°˜ ë ˆì´ì–´ (Session 2-3)
| Session | ì‘ì—… | ìœ„í—˜ë„ | ì˜ˆìƒ ê·œëª¨ |
|---------|------|--------|-----------|
| **2** | domain ë ˆì´ì–´ ê°•í™” (ì¸í„°í˜ì´ìŠ¤ í™•ì¶©) | ğŸŸ¢ ë‚®ìŒ | ~1000ì¤„ ì¶”ê°€ |
| **3** | application ë ˆì´ì–´ êµ¬ì¶• (Use Cases) | ğŸŸ¡ ì¤‘ê°„ | ~3000ì¤„ ì´ë™/ì¶”ê°€ |

### Phase 2: ì–´ëŒ‘í„° ë ˆì´ì–´ (Session 4-6)
| Session | ì‘ì—… | ìœ„í—˜ë„ | ì˜ˆìƒ ê·œëª¨ |
|---------|------|--------|-----------|
| **4** | ontology ëª¨ë“ˆ ë¦¬íŒ©í† ë§ (ì¤‘ë³µ í†µí•©) | ğŸŸ¡ ì¤‘ê°„ | ~2000ì¤„ ì •ë¦¬ |
| **5** | rag ëª¨ë“ˆ ë¦¬íŒ©í† ë§ (ì¤‘ë³µ í†µí•©) | ğŸŸ¡ ì¤‘ê°„ | ~1500ì¤„ ì •ë¦¬ |
| **6** | memory + monitoring + shared ì •ë¦¬ | ğŸŸ¢ ë‚®ìŒ | ~500ì¤„ |

### Phase 3: í•µì‹¬ ë ˆì´ì–´ (Session 7-8)
| Session | ì‘ì—… | ìœ„í—˜ë„ | ì˜ˆìƒ ê·œëª¨ |
|---------|------|--------|-----------|
| **7** | tools ë¶„í•  + core ìˆœí™˜ ì˜ì¡´ì„± í•´ì†Œ | ğŸ”´ ë†’ìŒ | ~15Kì¤„ ì¬êµ¬ì¡°í™” |
| **8** | agents ë¦¬íŒ©í† ë§ + ìˆœí™˜ ì˜ì¡´ì„± í•´ì†Œ | ğŸ”´ ë†’ìŒ | ~5Kì¤„ ì¬êµ¬ì¡°í™” |

### Phase 4: ë§ˆë¬´ë¦¬ (Session 9)
| Session | ì‘ì—… | ìœ„í—˜ë„ | ì˜ˆìƒ ê·œëª¨ |
|---------|------|--------|-----------|
| **9** | API ë¼ìš°íŠ¸ ì •ë¦¬ + dashboard_api.py ë¶„í•  + ìµœì¢… ê²€ì¦ | ğŸŸ¡ ì¤‘ê°„ | ~5Kì¤„ ì¬êµ¬ì¡°í™” |

---

## ê° ì„¸ì…˜ì˜ ì›Œí¬í”Œë¡œìš°

```
1. ì´ì „ ì„¸ì…˜ ê²°ê³¼ í™•ì¸ (í…ŒìŠ¤íŠ¸ í†µê³¼ ì—¬ë¶€)
2. í•´ë‹¹ ëª¨ë“ˆ ì½”ë“œ ì½ê¸° + ì˜ì¡´ì„± íŒŒì•…
3. ì•ˆì „ë§ í…ŒìŠ¤íŠ¸ ë³´ê°• (í•´ë‹¹ ëª¨ë“ˆ)
4. ë¦¬íŒ©í† ë§ ì‹¤í–‰
5. í…ŒìŠ¤íŠ¸ ì‹¤í–‰ â†’ ì‹¤íŒ¨ ì‹œ ìˆ˜ì •
6. ë¡œì»¬ ì„œë²„ ë™ì‘ í™•ì¸ ê°€ì´ë“œ ì œê³µ
```

---

## ìµœì¢… ëª©í‘œ êµ¬ì¡°

```
src/
â”œâ”€â”€ domain/              # Layer 1: ì—”í‹°í‹°, ì¸í„°í˜ì´ìŠ¤ (ì˜ì¡´ ì—†ìŒ)
â”‚   â”œâ”€â”€ entities/        # Product, Brand, Category, Metric
â”‚   â”œâ”€â”€ interfaces/      # Protocol í´ë˜ìŠ¤ (Agent, Retriever, Scraper, KG ë“±)
â”‚   â”œâ”€â”€ value_objects/   # VO
â”‚   â””â”€â”€ exceptions.py
â”œâ”€â”€ application/         # Layer 2: Use Cases
â”‚   â”œâ”€â”€ workflows/       # CrawlWorkflow, ChatWorkflow, InsightWorkflow
â”‚   â””â”€â”€ services/        # ê³µí†µ ì„œë¹„ìŠ¤
â”œâ”€â”€ ontology/            # Layer 3-A: KG + ì¶”ë¡  (domainë§Œ ì˜ì¡´)
â”‚   â”œâ”€â”€ knowledge_graph.py
â”‚   â”œâ”€â”€ reasoner.py      # owl_reasoner + reasoner í†µí•©
â”‚   â””â”€â”€ business_rules.py
â”œâ”€â”€ rag/                 # Layer 3-B: RAG (domain + ontologyë§Œ ì˜ì¡´)
â”‚   â”œâ”€â”€ hybrid_retriever.py  # retriever + hybrid í†µí•©
â”‚   â”œâ”€â”€ reranker.py
â”‚   â”œâ”€â”€ chunker.py
â”‚   â””â”€â”€ ...
â”œâ”€â”€ memory/              # Layer 3-C: ì„¸ì…˜/ì»¨í…ìŠ¤íŠ¸
â”œâ”€â”€ monitoring/          # Layer 3-D: ë¡œê¹…/ë©”íŠ¸ë¦­
â”œâ”€â”€ shared/              # Layer 3-E: LLM í´ë¼ì´ì–¸íŠ¸ ë“±
â”œâ”€â”€ agents/              # Layer 4-A: AI ì—ì´ì „íŠ¸ (ì¸í„°í˜ì´ìŠ¤ í†µí•´ ì˜ì¡´)
â”œâ”€â”€ tools/               # Layer 4-B: ì™¸ë¶€ ë„êµ¬ (ë¶„ë¥˜ë³„ í•˜ìœ„ íŒ¨í‚¤ì§€)
â”‚   â”œâ”€â”€ scrapers/        # amazon, social media
â”‚   â”œâ”€â”€ calculators/     # metrics, period
â”‚   â”œâ”€â”€ exporters/       # dashboard, report, csv
â”‚   â”œâ”€â”€ collectors/      # external signals, public data
â”‚   â””â”€â”€ utilities/       # backup, brand resolver ë“±
â”œâ”€â”€ core/                # Layer 4-C: ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
â”‚   â””â”€â”€ brain.py         # ìŠ¤ì¼€ì¤„ëŸ¬ (ì¸í„°í˜ì´ìŠ¤ í†µí•´ ì˜ì¡´)
â”œâ”€â”€ api/                 # Layer 4-D: FastAPI ë¼ìš°íŠ¸
â”‚   â””â”€â”€ routes/
â””â”€â”€ infrastructure/      # Layer 4-E: DI ì»¨í…Œì´ë„ˆ, ì„¤ì •
    â”œâ”€â”€ bootstrap.py
    â””â”€â”€ config/
```

---

## ì‚¬ìš© ë°©ë²•

1. `docs/refactoring/session_XX_*.md` íŒŒì¼ì„ ì—´ì–´ í”„ë¡¬í”„íŠ¸ë¥¼ ë³µì‚¬
2. ìƒˆ Claude Code ì„¸ì…˜ì—ì„œ ë¶™ì—¬ë„£ê¸°
3. ì„¸ì…˜ ì™„ë£Œ í›„ ë¡œì»¬ì—ì„œ `python3 -m pytest tests/ -v` ì‹¤í–‰
4. ëª¨ë“  ì„¸ì…˜ ì™„ë£Œ í›„ ìµœì¢… ë¡œì»¬ ê²€ì¦ â†’ í‘¸ì‹œ ê²°ì •
